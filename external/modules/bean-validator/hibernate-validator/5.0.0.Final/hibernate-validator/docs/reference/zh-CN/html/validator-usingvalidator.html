<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><title xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory">第 2 章 Validation step by step</title><link rel="stylesheet" href="css/hibernate.css" type="text/css"/><meta xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" name="generator" content="DocBook XSL Stylesheets V1.74.0"/><link rel="home" href="index.html" title="Hibernate Validator"/><link rel="up" href="index.html" title="Hibernate Validator"/><link rel="prev" href="validator-gettingstarted.html" title="第 1 章 开始入门"/><link rel="next" href="validator-customconstraints.html" title="第 3 章 创建自己的约束规则"/></head><body><p id="title"><a href="http://www.hibernate.org" class="site_href"><strong>Hibernate.org</strong></a><a href="http://hibernate.org/Documentation/DocumentationOverview" class="doc_href"><strong>Community Documentation</strong></a></p><ul class="docnav"><li class="previous"><a accesskey="p" href="validator-gettingstarted.html"><strong>上一页</strong></a></li><li class="next"><a accesskey="n" href="validator-customconstraints.html"><strong>下一页</strong></a></li></ul><div class="chapter" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-usingvalidator"/>第 2 章 Validation step by step</h2></div></div></div><div class="toc"><dl><dt><span class="section"><a href="validator-usingvalidator.html#validator-usingvalidator-annotate">2.1. 定义约束</a></span></dt><dd><dl><dt><span class="section"><a href="validator-usingvalidator.html#d0e300">2.1.1. 字段级(field level) 约束</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#d0e322">2.1.2. 属性级别约束</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#d0e353">2.1.3. 类级别约束</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#d0e382">2.1.4. 约束继承</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#d0e431">2.1.5. 对象图</a></span></dt></dl></dd><dt><span class="section"><a href="validator-usingvalidator.html#validator-usingvalidator-validate">2.2. 校验约束</a></span></dt><dd><dl><dt><span class="section"><a href="validator-usingvalidator.html#section-obtaining-validator">2.2.1. 获取一个Validator的实例</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#d0e580">2.2.2. Validator中的方法</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#d0e669">2.2.3. ConstraintViolation 中的方法</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#section-message-interpolation">2.2.4. 验证失败提示信息解析</a></span></dt></dl></dd><dt><span class="section"><a href="validator-usingvalidator.html#validator-usingvalidator-validationgroups">2.3. 校验组</a></span></dt><dd><dl><dt><span class="section"><a href="validator-usingvalidator.html#d0e982">2.3.1. 校验组序列</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#section-default-group-class">2.3.2. 对一个类重定义其默认校验组</a></span></dt></dl></dd><dt><span class="section"><a href="validator-usingvalidator.html#validator-defineconstraints-builtin">2.4. 内置的约束条件</a></span></dt><dd><dl><dt><span class="section"><a href="validator-usingvalidator.html#validator-defineconstraints-spec">2.4.1. Bean Validation constraints</a></span></dt><dt><span class="section"><a href="validator-usingvalidator.html#validator-defineconstraints-hv-constraints">2.4.2. Additional constraints</a></span></dt></dl></dd></dl></div><p>在本章中,我们会详细的介绍如何使用Hibernate Validator 来对一个给定的实体模型进行验证. 还会介绍Bean Validation规范提供了哪些默认的约束条件和Hibernate Validator提供了哪些额外的. 让我们先从如何给一个实体添加约束开始.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-usingvalidator-annotate"/>2.1. 定义约束</h2></div></div></div><p>Bean Validation 的约束是通过Java 注解(annotations)来标注的. 在本节中,我们会介绍如何使用这些注解(annotations)来标注一个实体模型.  并且,我们会区分三种不通的注解(annotations) 类型.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>不是所有的约束都能够被用在所有的类结构上. 事实上, 没有任何定义在Bean Validation规范中的约束可以被用在class上. 约束定义中的<code class="classname">java.lang.annotation.Target</code>属性定义了这个约束能够被使用在哪个层次结构上. 详细信息请参考<a class="xref" href="validator-customconstraints.html" title="第 3 章 创建自己的约束规则">第 3 章 <i>创建自己的约束规则</i></a>.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e300"/>2.1.1. 字段级(field level) 约束</h3></div></div></div><p>约束条件能够被标注在类的字段上面, 请参考示例<a class="xref" href="validator-usingvalidator.html#example-field-level" title="例 2.1. 字段级(field level) 约束">例 2.1 “字段级(field level) 约束”</a></p><div class="example"><a id="example-field-level"/><p class="title"><b>例 2.1. 字段级(field level) 约束</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mycompany</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">isRegistered&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>当约束被定义在字段上的时候, 这个字段的值是通过字段访问策略来获取并验证的. 也就是说Bean Validation的实现者会直接访问这个实例变量而不会调用属性的访问器(getter) 即使这个方法存在.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>这个字段的访问级别( private, protected 或者 public) 对此没有影响.</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>静态字段或者属性是不会被校验的.</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>When validating byte code enhanced objects property level constraints should be used, because the byte code enhancing library won't be able to determine a field access via reflection.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e322"/>2.1.2. 属性级别约束</h3></div></div></div><p>如果你的模型遵循<a class="ulink" href="http://java.sun.com/javase/technologies/desktop/javabeans/index.jsp">JavaBeans</a>规范的话, 你还可以把约束标注在属性上. <a class="xref" href="validator-usingvalidator.html#example-property-level" title="例 2.2. 属性级约束">例 2.2 “属性级约束”</a>和<a class="xref" href="validator-usingvalidator.html#example-field-level" title="例 2.1. 字段级(field level) 约束">例 2.1 “字段级(field level) 约束”</a>的唯一不同就是它的约束是定义在属性级别上的.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>如果要定义约束在属性级别上的话,那么只能定义在访问器(getter)上面,不能定义在修改器(setter)上.</p></div><div class="example"><a id="example-property-level"/><p class="title"><b>例 2.2. 属性级约束</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mycompany</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">AssertTrue</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">isRegistered&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getManufacturer</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setManufacturer</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setRegistered</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">isRegistered&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;isRegistered</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>When using property level constraints property access strategy is used to access the value to be validated. This means the bean validation provider accesses the state via the property accessor method. One advantage of annotating properties instead of fields is that the constraints become part of the constrained type's API that way and users are aware of the existing constraints without having to examine the type's implementation.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>It is recommended to stick either to field <span class="emphasis"><em>or</em></span> property annotations within one class. It is not recommended to annotate a field <span class="emphasis"><em>and</em></span> the accompanying getter method as this would cause the field to be validated twice.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e353"/>2.1.3. 类级别约束</h3></div></div></div><p>Last but not least, a constraint can also be placed on class level. When a constraint annotation is placed on this level the class instance itself passed to the <code class="classname">ConstraintValidator</code>. Class level constraints are useful if it is necessary to inspect more than a single property of the class to validate it or if a correlation between different state variables has to be evaluated. In <a class="xref" href="validator-usingvalidator.html#example-class-level" title="例 2.3. 类级别约束">例 2.3 “类级别约束”</a> we add the property <span class="property">passengers</span> to the class <code class="classname">Car</code>. We also add the constraint <code class="classname">PassengerCount</code> on the class level. We will later see how we can actually create this custom constraint (see <a class="xref" href="validator-customconstraints.html" title="第 3 章 创建自己的约束规则">第 3 章 <i>创建自己的约束规则</i></a>). For now it is enough to know that <code class="classname">PassengerCount</code> will ensure that there cannot be more passengers in a car than there are seats.</p><div class="example"><a id="example-class-level"/><p class="title"><b>例 2.3. 类级别约束</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mycompany</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">Min</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">Size</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">PassengerCount</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e382"/>2.1.4. 约束继承</h3></div></div></div><p>如果要验证的对象继承于某个父类或者实现了某个接口,那么定义在父类或者接口中的约束会在验证这个对象的时候被自动加载,如同这些约束定义在这个对象所在的类中一样. 让我们来看看下面的示例:</p><div class="example"><a id="d0e387"/><p class="title"><b>例 2.4. 约束继承</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mycompany</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">(</span><span class="java_plain">manufacturer</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">rentalStation&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getRentalStation</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setRentalStation</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">rentalStation&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;rentalStation</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>我们有了一个新的<code class="classname">RentalCar</code>类继承自前面我们已经见到的<code class="classname">Car</code>, 这个子类中增加了一个<span class="property">rentalStation</span>属性. 如果校验一个<code class="classname">RentalCar</code>的实例对象, 那么不仅会验证属性<span class="property">rentalStation</span>上的 <code class="classname">@NotNull</code>约束是否合法,还会校验父类中的<span class="property">manufacturer</span>属性.</p><p>如果类<code class="classname">Car</code>是一个接口类型的话也是一样的效果.</p><p>如果类<code class="classname">RentalCar</code> 重写了父类<code class="classname">Car</code>的<code class="methodname">getManufacturer()</code>方法, 那么定义在父类的这个方法上的约束和子类这个方法上定义的约束都会被校验.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e431"/>2.1.5. 对象图</h3></div></div></div><p>Bean Validation API不仅能够用来校验单个的实例对象,还能够用来校验完整的对象图.要使用这个功能,只需要在一个有关联关系的字段或者属性上标注<code class="classname">@Valid</code>. 这样,如果一个对象被校验,那么它的所有的标注了<code class="classname">@Valid</code>的关联对象都会被校验. 请看<a class="xref" href="validator-usingvalidator.html#example-car-with-driver" title="例 2.6. Adding a driver to the car">例 2.6 “Adding a driver to the car”</a>.</p><div class="example"><a id="d0e444"/><p class="title"><b>例 2.5. Class Person</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mycompany</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;getName</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setName</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div class="example"><a id="example-car-with-driver"/><p class="title"><b>例 2.6. Adding a driver to the car</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mycompany</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_type">Valid</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">Person</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">driver&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>如果校验<code class="classname">Car</code>的实例对象的话,因为它的<span class="property">driver</span>属性标注了<code class="classname">@Valid</code>, 那么关联的<code class="classname">Person</code>也会被校验. 所以,如果对象<code class="classname">Person</code>的<span class="property">name</span>属性如果是<code class="code">null</code>的话,那么校验会失败.</p><p>关联校验也适用于集合类型的字段, 也就是说,任何下列的类型:</p><div class="itemizedlist"><ul><li><p>数组</p></li><li><p>实现了<code class="classname">java.lang.Iterable</code>接口( 例如<code class="classname">Collection</code>, <code class="classname">List</code> 和 <code class="classname">Set</code>)</p></li><li><p>实现了<code class="classname">java.util.Map</code>接口</p></li></ul></div><p>如果标注了<code class="classname">@Valid</code>, 那么当主对象被校验的时候,这些集合对象中的元素都会被校验.</p><div class="example"><a id="d0e509"/><p class="title"><b>例 2.7. Car with a list of passengers</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">package</span><!-- <br/> --><span class="java_plain">&nbsp;com</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">mycompany</span><!-- <br/> --><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_type">ArrayList</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_type">List</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_type">Valid</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_keyword">import</span><span class="java_plain">&nbsp;javax</span><span class="java_separator">.</span><span class="java_plain">validation</span><span class="java_separator">.</span><span class="java_plain">constraints</span><span class="java_separator">.</span><span class="java_type">NotNull</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ArrayList</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Person</span><span class="java_operator">&gt;</span><span class="java_plain">&nbsp;passengers</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">passengers&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;passengers</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>当校验一个<code class="classname">Car</code>的实例的时候,如果<span class="property">passengers</span> list中包含的任何一个<code class="classname">Person</code>对象没有名字的话,都会导致校验失败(a <code class="classname">ConstraintValidation</code> will be created).</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>对象图校验的时候是会被忽略<code class="classname">null</code>值的.</p></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-usingvalidator-validate"/>2.2. 校验约束</h2></div></div></div><p><code class="classname">Validator</code> 是Bean Validation中最主要的接口, 我们会在<a class="xref" href="validator-bootstrapping.html#section-validator-instance" title="5.1. Configuration 和 ValidatorFactory">第 5.1 节 “Configuration 和 ValidatorFactory”</a>中详细介绍如何获取一个<code class="classname">Validator</code>的实例, 现在先让我们来看看如何使用<code class="classname">Validator</code>接口中的各个方法. </p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-obtaining-validator"/>2.2.1. 获取一个<code class="classname">Validator</code>的实例</h3></div></div></div><p>对一个实体对象验证之前首先需要有个<code class="classname">Validator</code>对象, 而这个对象是需要通过<code class="classname">Validation</code> 类和 <code class="classname">ValidatorFactory</code>来创建的. 最简单的方法是调用<code class="methodname">Validation.buildDefaultValidatorFactory()</code> 这个静态方法. </p><div class="example"><a id="d0e569"/><p class="title"><b>例 2.8. Validation.buildDefaultValidatorFactory()</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;factory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span></pre></div></div><br class="example-break"/><p><a class="xref" href="validator-bootstrapping.html" title="第 5 章 Bootstrapping">第 5 章 <i>Bootstrapping</i></a>介绍了其他的获取Validator实例的方法. 现在我们的目标是学习如何使用<code class="classname">Validator</code> 来校验实体对象.</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e580"/>2.2.2. Validator中的方法</h3></div></div></div><p><code class="classname">Validator</code>中有三个方法能够被用来校验整个实体对象或者实体对象中的属性.</p><p>这三个方法都会返回一个<code class="classname">Set&lt;ConstraintViolation&gt;</code>对象, 如果整个验证过程没有发现问题的话,那么这个set是空的, 否则, 每个违反约束的地方都会被包装成一个<code class="classname">ConstraintViolation</code>的实例然后添加到set当中. </p><p>All the validation methods have a var-args parameter which can be used to specify, which validation groups shall be considered when performing the validation. If the parameter is not specified the default validation group (<code class="classname">javax.validation.groups.Default</code>) will be used. We will go into more detail on the topic of validation groups in <a class="xref" href="validator-usingvalidator.html#validator-usingvalidator-validationgroups" title="2.3. 校验组">第 2.3 节 “校验组”</a></p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e601"/>2.2.2.1. <code class="methodname">validate</code></h4></div></div></div><p>使用<code class="methodname">validate()</code>方法对一个给定的实体对象中定义的所有约束条件进行校验 (<a class="xref" href="validator-usingvalidator.html#example-validator-validate" title="例 2.9. Validator.validate() 使用方法">例 2.9 “Validator.validate() 使用方法”</a> ).</p><div class="example"><a id="example-validator-validate"/><p class="title"><b>例 2.9. <code class="methodname">Validator.validate()</code> 使用方法</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">ValidatorFactory</span><!-- <br/> --><span class="java_plain">&nbsp;factory&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">();</span>
<!--  --><br/><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_literal">null</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">car</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">());</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">());</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e619"/>2.2.2.2. <code class="methodname">validateProperty</code></h4></div></div></div><p>通过<code class="methodname">validateProperty()</code>可以对一个给定实体对象的单个属性进行校验. 其中属性名称需要符合JavaBean规范中定义的属性名称.</p><div class="example"><a id="d0e628"/><p class="title"><b>例 2.10. <code class="methodname">Validator.validateProperty()</code>使用方法</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">getValidator</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_literal">null</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateProperty</span><span class="java_separator">(</span><span class="java_plain">car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">());</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">());</span></pre></div></div><br class="example-break"/><p>例如, <code class="methodname">Validator.validateProperty</code>可以被用在把Bean Validation集成进JSF 2中的时候使用 (请参考 <a class="xref" href="validator-integration.html#section-presentation-layer" title="7.4. 展示层校验">第 7.4 节 “展示层校验”</a>).</p></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e642"/>2.2.2.3. <code class="methodname">validateValue</code></h4></div></div></div><p>通过<code class="methodname">validateValue() </code>方法,你能够校验如果把一个特定的值赋给一个类的某一个属性的话,是否会违反此类中定义的约束条件.</p><div class="example"><a id="d0e651"/><p class="title"><b>例 2.11. <code class="methodname">Validator.validateValue()</code> 使用方法</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_type">Validator</span><!-- <br/> --><span class="java_plain">&nbsp;validator&nbsp;</span><!-- <br/> --><span class="java_operator">=</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Validation</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_plain">buildDefaultValidatorFactory</span><!-- <br/> --><span class="java_separator">().</span><!-- <br/> --><span class="java_plain">getValidator</span><!-- <br/> --><span class="java_separator">();</span>
</span>
<!--  --><br/><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validateValue</span><span class="java_separator">(</span><span class="java_type">Car</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;manufacturer&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">());</span>
<!--  --><br/><span class="java_plain">assertEquals</span><span class="java_separator">(</span><span class="java_literal">&quot;may&nbsp;not&nbsp;be&nbsp;null&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">());</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p><code class="methodname">validateProperty()</code> 和 <code class="methodname">validateValue()</code> 会忽略被验证属性上定义的<code class="classname">@Valid</code>.</p></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e669"/>2.2.3. <code class="classname">ConstraintViolation</code> 中的方法</h3></div></div></div><p>现在是时候看看究竟<code class="classname">ConstraintViolation</code>是什么了. <code class="classname">ConstraintViolation</code>中包含了很多方法能够帮你快速定位究竟是什么导致了校验失败.<a class="xref" href="validator-usingvalidator.html#table-constraint-violation" title="表 2.1. ConstraintViolation 中的方法">表 2.1 “ConstraintViolation 中的方法”</a> 列出了这些方法:</p><div class="table"><a id="table-constraint-violation"/><p class="title"><b>表 2.1. <code class="classname">ConstraintViolation</code> 中的方法</b></p><div class="table-contents"><table summary="ConstraintViolation 中的方法" border="1"><colgroup><col/><col/><col/></colgroup><thead><tr><th>方法名</th><th>作用</th><th>示例 (请参考<a class="xref" href="validator-usingvalidator.html#example-validator-validate" title="例 2.9. Validator.validate() 使用方法">例 2.9 “Validator.validate() 使用方法”</a>)</th></tr></thead><tbody><tr><td><code class="methodname">getMessage()</code></td><td>获取(经过翻译的)校验错误信息</td><td>may not be null</td></tr><tr><td><code class="methodname">getMessageTemplate()</code></td><td>获取错误信息模版</td><td>{javax.validation.constraints.NotNull.message}</td></tr><tr><td><code class="methodname">getRootBean()</code></td><td>获取被校验的根实体对象</td><td>car</td></tr><tr><td><code class="methodname">getRootBeanClass()</code></td><td>获取被校验的根实体类.</td><td>Car.class</td></tr><tr><td><code class="methodname">getLeafBean()</code></td><td>如果约束是添加在一个bean(实体对象)上的,那么则返回这个bean的实例, 如果是约束是定义在一个属性上的, 则返回这个属性所属的bean的实例对象. </td><td>car</td></tr><tr><td><code class="methodname">getPropertyPath()</code></td><td>从被验证的根对象到被验证的属性的路径.</td><td> </td></tr><tr><td><code class="methodname">getInvalidValue()</code></td><td>倒是校验失败的值.</td><td>passengers</td></tr><tr><td><code class="methodname">getConstraintDescriptor()</code></td><td>导致校验失败的约束定义.</td><td> </td></tr></tbody></table></div></div><br class="table-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-message-interpolation"/>2.2.4. 验证失败提示信息解析</h3></div></div></div><p>在<a class="xref" href="validator-customconstraints.html" title="第 3 章 创建自己的约束规则">第 3 章 <i>创建自己的约束规则</i></a>中,我们会看到,每个约束定义中都包含有一个用于提示验证结果的消息模版, 并且在声明一个约束条件的时候,你可以通过这个约束中的<code class="methodname">message</code>属性来重写默认的消息模版, 可以参考<a class="xref" href="validator-usingvalidator.html#example-driver" title="例 2.13. Driver">例 2.13 “Driver”</a>. 如果在校验的时候,这个约束条件没有通过,那么你配置的<code class="classname">MessageInterpolator</code>会被用来当成解析器来解析这个约束中定义的消息模版, 从而得到最终的验证失败提示信息. 这个解析器会尝试解析模版中的占位符( 大括号括起来的字符串 ). 其中, Hibernate Validator中默认的解析器 (<code class="classname">MessageInterpolator</code>) 会先在类路径下找名称为<code class="filename">ValidationMessages.properties</code>的<code class="classname">ResourceBundle</code>, 然后将占位符和这个文件中定义的resource进行匹配,如果匹配不成功的话,那么它会继续匹配Hibernate Validator自带的位于<code class="filename">/org/hibernate/validator/ValidationMessages.properties</code>的<code class="classname">ResourceBundle</code>, 依次类推,递归的匹配所有的占位符.</p><p>因为大括号{ 在这里是特殊字符,所以,你可以通过使用反斜线来对其进行转义, 例如:</p><div class="itemizedlist"><ul><li><p>\{ 被转义成 {</p></li><li><p>\} 被转义成 }</p></li><li><p>\\ 被转义成 \</p></li></ul></div><p>如果默认的消息解析器不能够满足你的需求,那么你也可以在创建<code class="classname">ValidatorFactory</code>的时候, 将其替换为一个你自定义的<code class="classname">MessageInterpolator</code>, 具体请参考 <a class="xref" href="validator-bootstrapping.html" title="第 5 章 Bootstrapping">第 5 章 <i>Bootstrapping</i></a>.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-usingvalidator-validationgroups"/>2.3. 校验组</h2></div></div></div><p>校验组能够让你在验证的时候选择应用哪些约束条件. 这样在某些情况下( 例如向导 ) 就可以对每一步进行校验的时候, 选取对应这步的那些约束条件进行验证了. 校验组是通过可变参数传递给<code class="methodname">validate</code>, <code class="methodname">validateProperty</code> 和 <code class="methodname">validateValue</code>的. 让我们来看个例子, 这个实例扩展了上面的<code class="classname">Car</code>类,又为其添加了一个新的<code class="classname">Driver</code>. 首先, 类<code class="classname">Person</code> (<a class="xref" href="validator-usingvalidator.html#example-person" title="例 2.12. Person">例 2.12 “Person”</a>) 的<span class="property">name</span>属性上定义了一个<code class="classname">@NotNull </code>的约束条件. 因为没有明确指定这个约束条件属于哪个组,所以它被归类到默认组 (<code class="classname">javax.validation.groups.Default</code>).</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>如果某个约束条件属于多个组,那么各个组在校验时候的顺序是不可预知的. 如果一个约束条件没有被指明属于哪个组,那么它就会被归类到默认组(<code class="classname">javax.validation.groups.Default</code>).</p></div><div class="example"><a id="example-person"/><p class="title"><b>例 2.12. Person</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Person</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Person</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">name&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;name</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;getters&nbsp;and&nbsp;setters&nbsp;</span><span class="java_separator">...</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>接下来, 我们让类<code class="classname">Driver</code> (<a class="xref" href="validator-usingvalidator.html#example-driver" title="例 2.13. Driver">例 2.13 “Driver”</a>) 继承自类<code class="classname">Person</code>. 然后添加两个属性,分别是<span class="property">age</span> 和 <span class="property">hasDrivingLicense</span>. 对于一个司机来说, 要开车的话, 必须满足两个条件, 年满18周岁 (<code class="classname">@Min(18)</code>) 和你的有驾照(<code class="classname">@AssertTrue</code>). 这两个约束条件分别定义在那两个属性上, 并且把他们都归于<code class="classname">DriverChecks</code>组. 通过<a class="xref" href="validator-usingvalidator.html#example-group-interfaces" title="例 2.14. Group interfaces">例 2.14 “Group interfaces”</a>, 你可以看到, "<code class="classname">DriverChecks</code>组" 就是一个简单的标记接口. 使用接口( 而不是字符串) 可以做到类型安全,并且接口比字符串更加对重构友好, 另外, 接口还意味着一个组可以继承别的组.</p><div class="example"><a id="example-driver"/><p class="title"><b>例 2.13. Driver</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Driver</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">extends</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Person</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_plain">value&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_separator">,</span><span class="java_plain">&nbsp;message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;You&nbsp;have&nbsp;to&nbsp;be&nbsp;18&nbsp;to&nbsp;drive&nbsp;a&nbsp;car&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;You&nbsp;first&nbsp;have&nbsp;to&nbsp;pass&nbsp;the&nbsp;driving&nbsp;test&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;hasDrivingLicense</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;name</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">(</span><span class="java_plain">&nbsp;name&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;passedDrivingTest</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;b</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;hasDrivingLicense&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;b</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;getAge</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setAge</span><span class="java_separator">(</span><span class="java_type">int</span><span class="java_plain">&nbsp;age</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">age&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;age</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div class="example"><a id="example-group-interfaces"/><p class="title"><b>例 2.14. Group interfaces</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">interface</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">DriverChecks</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>最后, 我们给<code class="classname">Car</code> class (<a class="xref" href="validator-usingvalidator.html#example-car" title="例 2.15. Car">例 2.15 “Car”</a>) 添加一个<span class="property">passedVehicleInspection</span>的属性,来表示这个车是否通过了上路检查.</p><div class="example"><a id="example-car"/><p class="title"><b>例 2.15. Car</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">Car</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">NotNull</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Size</span><span class="java_separator">(</span><span class="java_plain">min&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_separator">,</span><span class="java_plain">&nbsp;max&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">14</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licensePlate</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Min</span><span class="java_separator">(</span><span class="java_literal">2</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertTrue</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;has&nbsp;to&nbsp;pass&nbsp;the&nbsp;vehicle&nbsp;inspection&nbsp;first&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;passedVehicleInspection</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Valid</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_plain">&nbsp;driver</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">manufacturer&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">licensePlate&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">seatCount&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>现在, 在我们的例子中有三个不同的校验组, <span class="property">Person.name</span>, <span class="property">Car.manufacturer</span>, <span class="property">Car.licensePlate</span> 和 <span class="property">Car.seatCount</span>都属于默认(<code class="classname">Default</code>) 组, <span class="property">Driver.age</span> 和 <span class="property">Driver.hasDrivingLicense</span> 从属于 <code class="classname">DriverChecks</code>组, 而<span class="property">Car.passedVehicleInspection</span> 在<code class="classname">CarChecks</code>组中. <a class="xref" href="validator-usingvalidator.html#example-drive-away" title="例 2.16. Drive away">例 2.16 “Drive away”</a>演示了如何让<code class="methodname">Validator.validate</code>验证不同的组来得到不同的校验结果.</p><div class="example"><a id="example-drive-away"/><p class="title"><b>例 2.16. Drive away</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">GroupTest</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;</span><span class="java_type">Validator</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">BeforeClass</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">static</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setUp</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">ValidatorFactory</span><span class="java_plain">&nbsp;factory&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">Validation</span><span class="java_separator">.</span><span class="java_plain">buildDefaultValidatorFactory</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;validator&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;factory</span><span class="java_separator">.</span><span class="java_plain">getValidator</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">Test</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;driveAway</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;create&nbsp;a&nbsp;car&nbsp;and&nbsp;check&nbsp;that&nbsp;everything&nbsp;is&nbsp;ok&nbsp;with&nbsp;it</span><span class="java_separator">.</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">Car</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;but&nbsp;has&nbsp;it&nbsp;passed&nbsp;the&nbsp;vehicle&nbsp;inspection</span><span class="java_operator">?</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_literal">&quot;The&nbsp;car&nbsp;has&nbsp;to&nbsp;pass&nbsp;the&nbsp;vehicle&nbsp;inspection&nbsp;first&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">());</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;let's&nbsp;go&nbsp;to&nbsp;the&nbsp;vehicle&nbsp;inspection</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">setPassedVehicleInspection</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;now&nbsp;let's&nbsp;add&nbsp;a&nbsp;driver</span><span class="java_separator">.</span><span class="java_plain">&nbsp;</span><span class="java_type">He</span><span class="java_plain">&nbsp;is&nbsp;</span><span class="java_literal">18</span><span class="java_separator">,</span><span class="java_plain">&nbsp;but&nbsp;has&nbsp;not&nbsp;passed&nbsp;the&nbsp;driving&nbsp;test&nbsp;yet</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Driver</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;John&nbsp;Doe&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;john</span><span class="java_separator">.</span><span class="java_plain">setAge</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">setDriver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;You&nbsp;first&nbsp;have&nbsp;to&nbsp;pass&nbsp;the&nbsp;driving&nbsp;test&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;ok</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">John</span><span class="java_plain">&nbsp;passes&nbsp;the&nbsp;test</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;john</span><span class="java_separator">.</span><span class="java_plain">passedDrivingTest</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">//</span><span class="java_plain">&nbsp;just&nbsp;checking&nbsp;that&nbsp;everything&nbsp;is&nbsp;in&nbsp;order&nbsp;now</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">Default</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">DriverChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><p>首先我们创建一辆汽车然后在没有明确指定使用哪个校验组的情况下校验它, 可以看到即使<span class="property">passedVehicleInspection</span>的默认值是<code class="constant">false</code>也不会校验出错误来. 因为定义在这个属性上的约束条件并不属于默认的校验组, 接下来,我们来校验<code class="classname">CarChecks</code>这个组, 这样就会发现car违反了约束条件, 必须让这个车先通过检测. 接下来,我们给这个车增加一个司机, 然后在基于<code class="classname">DriverChecks</code>来校验, 会发现因为这个司机因为还没有通过驾照考试, 所以又一次得到了校验错误, 如果我们设置<span class="property">passedDrivingTest</span>属性为<code class="constant">true</code>之后, <code class="classname">DriverChecks</code>组的校验就通过了.</p><p>最后, 让我们再来校验所有的组中定义的约束条件,可以看到所有的约束条件都通过了验证.</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="d0e982"/>2.3.1. 校验组序列</h3></div></div></div><p>By default, constraints are evaluated in no particular order, regardless of which groups they belong to. In some situations, however, it is useful to control the order constraints are evaluated. In our example from <a class="xref" href="validator-usingvalidator.html#validator-usingvalidator-validationgroups" title="2.3. 校验组">第 2.3 节 “校验组”</a> we could for example require that first all default car constraints are passing before we check the road worthiness of the car. Finally before we drive away we check the actual driver constraints. In order to implement such an order one would define a new interface and annotate it with <code class="classname">@GroupSequence</code> defining the order in which the groups have to be validated.</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>If at least one constraint fails in a sequenced group none of the constraints of the following groups in the sequence get validated.</p></div><div class="example"><a id="example-orderedChecks"/><p class="title"><b>例 2.17. 标注了@GroupSequence的接口</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">GroupSequence</span><!-- <br/> --><span class="java_separator">({</span><!-- <br/> --><span class="java_type">Default</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">CarChecks</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">DriverChecks</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">interface</span><span class="java_plain">&nbsp;</span><span class="java_type">OrderedChecks</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="warning"><h2>警告</h2><p>一个校验组序列中包含的校验组和这个校验组序列不能造成直接或者间接的循环引用. 包括校验组继承. 如果造成了循环引用的话, 会导致<code class="classname">GroupDefinitionException</code>异常.</p></div><p><a class="xref" href="validator-usingvalidator.html#example-group-sequence" title="例 2.18. 校验组序列的用法">例 2.18 “校验组序列的用法”</a>展示了校验组序列的用法.</p><div class="example"><a id="example-group-sequence"/><p class="title"><b>例 2.18. 校验组序列的用法</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">Test</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;testOrderedChecks</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">setPassedVehicleInspection</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">Driver</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">Driver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;John&nbsp;Doe&quot;</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;john</span><span class="java_separator">.</span><span class="java_plain">setAge</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">18</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;john</span><span class="java_separator">.</span><span class="java_plain">passedDrivingTest</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;car</span><span class="java_separator">.</span><span class="java_plain">setDriver</span><span class="java_separator">(</span><span class="java_plain">&nbsp;john&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">OrderedChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">).</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="section-default-group-class"/>2.3.2. 对一个类重定义其默认校验组</h3></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1017"/>2.3.2.1. @GroupSequence</h4></div></div></div><p>The <code class="classname">@GroupSequence</code> annotation also fulfills a second purpose. It allows you to redefine what the <code class="constant">Default</code> group means for a given class. To redefine <code class="classname">Default</code> for a given class, add a <code class="classname">@GroupSequence</code> annotation to the class. The defined groups in the annotation express the sequence of groups that substitute <code class="classname">Default</code> for this class. <a class="xref" href="validator-usingvalidator.html#example-rental-car" title="例 2.19. RentalCar with @GroupSequence">例 2.19 “RentalCar with @GroupSequence”</a> introduces a new class <code class="classname">RentalCar</code> with a redefined default group. With this definition you can evaluate the constraints belonging to <code class="classname">RentalChecks</code>, <code class="classname">CarChecks</code> and <code class="classname">RentalCar</code> by just requesting the <code class="classname">Default</code> group as seen in <a class="xref" href="validator-usingvalidator.html#example-testCarIsRented" title="例 2.20. RentalCar with redefined default group">例 2.20 “RentalCar with redefined default group”</a>.</p><div class="example"><a id="example-rental-car"/><p class="title"><b>例 2.19. RentalCar with @GroupSequence</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">GroupSequence</span><!-- <br/> --><span class="java_separator">({</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">RentalChecks</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">CarChecks</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">,</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">RentalCar</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">})</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertFalse</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;is&nbsp;currently&nbsp;rented&nbsp;out&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">(</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;seatCount&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRented</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setRented</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">rented&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div class="example"><a id="example-testCarIsRented"/><p class="title"><b>例 2.20. RentalCar with redefined default group</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_javadoc_comment">/**</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*&nbsp;Validating&nbsp;the&nbsp;default&nbsp;group&nbsp;leads&nbsp;to&nbsp;validation&nbsp;on&nbsp;the&nbsp;default&nbsp;group&nbsp;sequence&nbsp;of&nbsp;{</span><span class="java_javadoc_tag">@code</span><span class="java_javadoc_comment">&nbsp;RentalCar}.</span>
<!--  --><br/><span class="java_javadoc_comment">&nbsp;*/</span>
<!--  --><br/><span class="java_plain">@</span><span class="java_type">Test</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;carIsRented</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;rentalCar&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;Morris&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;DD-AB-123&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">2</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;rentalCar</span><span class="java_separator">.</span><span class="java_plain">setPassedVehicleInspection</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;rentalCar</span><span class="java_separator">.</span><span class="java_plain">setRented</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">true</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_type">Set</span><span class="java_operator">&lt;</span><span class="java_type">ConstraintViolation</span><span class="java_operator">&lt;</span><span class="java_type">RentalCar</span><span class="java_operator">&gt;&gt;</span><span class="java_plain">&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;rentalCar&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">1</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;Wrong&nbsp;message&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;is&nbsp;currently&nbsp;rented&nbsp;out&quot;</span><span class="java_separator">,</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">iterator</span><span class="java_separator">().</span><span class="java_plain">next</span><span class="java_separator">().</span><span class="java_plain">getMessage</span><span class="java_separator">()</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;rentalCar</span><span class="java_separator">.</span><span class="java_plain">setRented</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">false</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;constraintViolations&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;validator</span><span class="java_separator">.</span><span class="java_plain">validate</span><span class="java_separator">(</span><span class="java_plain">&nbsp;rentalCar&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;assertEquals</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_literal">0</span><span class="java_separator">,</span><span class="java_plain">&nbsp;constraintViolations</span><span class="java_separator">.</span><span class="java_plain">size</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Due to the fact that there cannot be a cyclic dependency in the group and group sequence definitions one cannot just add <code class="classname">Default</code> to the sequence redefining <code class="classname">Default</code> for a class. Instead the class itself has to be added!</p></div><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>The <code class="classname">Default</code> group sequence overriding is local to the class it is defined on and is not propagated to the associated objects. This means in particular that adding <code class="classname">DriverChecks</code> to the default group sequence of <code class="classname">RentalCar</code> would not have any effects. Only the group <code class="classname">Default</code> will be propagated to the driver association when validation a rental car instance.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1090"/>2.3.2.2. @GroupSequenceProvider</h4></div></div></div><p>The <code class="classname">@javax.validation.GroupSequence</code> annotation is a standardized Bean Validation annotation. As seen in the previous section it allows you to statically redefine the default group sequence for a class. Hibernate Validator also offers a custom, non standardized annotation - <code class="classname">org.hibernate.validator.group.GroupSequenceProvider </code>- which allows for dynamic redefinition of the default group sequence. Using the rental car scenario again, one could dynamically add the <code class="classname">CarChecks</code> as seen in <a class="xref" href="validator-usingvalidator.html#example-rental-car-group-sequence-provider" title="例 2.21. RentalCar with @GroupSequenceProvider">例 2.21 “RentalCar with @GroupSequenceProvider”</a> and <a class="xref" href="validator-usingvalidator.html#example-group-sequence-provider-implementation" title="例 . DefaultGroupSequenceProvider implementation">例  “DefaultGroupSequenceProvider implementation”</a>.</p><div class="example"><a id="example-rental-car-group-sequence-provider"/><p class="title"><b>例 2.21. RentalCar with @GroupSequenceProvider</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_plain">@</span><!-- <br/> --><span class="java_type">GroupSequenceProvider</span><!-- <br/> --><span class="java_separator">(</span><!-- <br/> --><span class="java_type">RentalCarGroupSequenceProvider</span><!-- <br/> --><span class="java_separator">.</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_separator">)</span>
<!--  --><br/><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;</span><span class="java_keyword">extends</span><span class="java_plain">&nbsp;</span><span class="java_type">Car</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;@</span><span class="java_type">AssertFalse</span><span class="java_separator">(</span><span class="java_plain">message&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;The&nbsp;car&nbsp;is&nbsp;currently&nbsp;rented&nbsp;out&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;groups&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_separator">)</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;seatCount</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">super</span><span class="java_separator">(</span><span class="java_plain">&nbsp;manufacturer</span><span class="java_separator">,</span><span class="java_plain">&nbsp;licencePlate</span><span class="java_separator">,</span><span class="java_plain">&nbsp;seatCount&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;isRented</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setRented</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">rented&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;rented</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/><div class="example"><a id="example-group-sequence-provider-implementation"/><p class="title"><b>例 . DefaultGroupSequenceProvider implementation</b></p><div class="example-contents"><pre xmlns="" xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="JAVA"><!-- <br/> --><span class="java_keyword">public</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">class</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">RentalCarGroupSequenceProvider</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_keyword">implements</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_type">DefaultGroupSequenceProvider</span><!-- <br/> --><span class="java_operator">&lt;</span><!-- <br/> --><span class="java_type">RentalCar</span><!-- <br/> --><span class="java_operator">&gt;</span><!-- <br/> --><span class="java_plain">&nbsp;</span><!-- <br/> --><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">&nbsp;getValidationGroups</span><span class="java_separator">(</span><span class="java_type">RentalCar</span><span class="java_plain">&nbsp;car</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">List</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_plain">&nbsp;defaultGroupSequence&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">ArrayList</span><span class="java_operator">&lt;</span><span class="java_type">Class</span><span class="java_operator">&lt;?&gt;&gt;</span><span class="java_separator">();</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defaultGroupSequence</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">RentalCar</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;car&nbsp;</span><span class="java_operator">!=</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_plain">&nbsp;</span><span class="java_operator">&amp;&amp;</span><span class="java_plain">&nbsp;</span><span class="java_operator">!</span><span class="java_plain">car</span><span class="java_separator">.</span><span class="java_plain">isRented</span><span class="java_separator">()</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;defaultGroupSequence</span><span class="java_separator">.</span><span class="java_plain">add</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_type">CarChecks</span><span class="java_separator">.</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;</span><span class="java_separator">);</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;defaultGroupSequence</span><span class="java_separator">;</span>
<!--  --><br/><span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span>
<!--  --><br/><span class="java_separator">}</span></pre></div></div><br class="example-break"/></div></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h2 class="title"><a id="validator-defineconstraints-builtin"/>2.4. 内置的约束条件</h2></div></div></div><p>Hibernate Validator comprises a basic set of commonly used constraints. These are foremost the constraints defined by the Bean Validation specification (see <a class="xref" href="validator-usingvalidator.html#table-spec-constraints" title="表 2.2. Bean Validation constraints">表 2.2 “Bean Validation constraints”</a>). Additionally, Hibernate Validator provides useful custom constraints (see <a class="xref" href="validator-usingvalidator.html#table-custom-constraints" title="表 2.3. Custom constraints">表 2.3 “Custom constraints”</a> and <a class="xref" href="validator-usingvalidator.html#table-custom-country-constraints" title="表 2.4. Custom country specific constraints">表 2.4 “Custom country specific constraints”</a>).</p><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-defineconstraints-spec"/>2.4.1. Bean Validation constraints</h3></div></div></div><p><a class="xref" href="validator-usingvalidator.html#table-spec-constraints" title="表 2.2. Bean Validation constraints">表 2.2 “Bean Validation constraints”</a> shows purpose and supported data types of all constraints specified in the Bean Validation API. All these constraints apply to the field/property level, there are no class-level constraints defined in the Bean Validation specification. If you are using the Hibernate object-relational mapper, some of the constraints are taken into account when creating the DDL for your model (see column "Hibernate metadata impact").</p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>Hibernate Validator allows some constraints to be applied to more data types than required by the Bean Validation specification (e.g. @Max can be applied to <code class="classname">Strings</code>). Relying on this feature can impact portability of your application between Bean Validation providers.</p></div><div class="table"><a id="table-spec-constraints"/><p class="title"><b>表 2.2. Bean Validation constraints</b></p><div class="table-contents"><table summary="Bean Validation constraints" border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Supported data types</th><th align="left">作用</th><th align="left">Hibernate metadata impact</th></tr></thead><tbody valign="top"><tr><td align="left" valign="top">@AssertFalse</td><td align="left" valign="top"><code class="classname">Boolean</code>, <code class="classname">boolean</code></td><td align="left" valign="top">Checks that the annotated element is <code class="constant">false</code>.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@AssertTrue</td><td align="left" valign="top"><code class="classname">Boolean</code>, <code class="classname">boolean</code></td><td align="left" valign="top">Checks that the annotated element is <code class="constant">true</code>.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@DecimalMax</td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">String</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types. Additionally supported by HV: any sub-type of <code class="classname">Number</code> and <code class="classname">CharSequence</code>.</td><td align="left" valign="top">被标注的值必须不大于约束中指定的最大值. 这个约束的参数是一个通过<code class="classname">BigDecimal</code>定义的最大值的字符串表示.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@DecimalMin</td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">String</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types. Additionally supported by HV: any sub-type of <code class="classname">Number </code>and <code class="classname">CharSequence</code>.</td><td align="left" valign="top">被标注的值必须不小于约束中指定的最小值. 这个约束的参数是一个通过<code class="classname">BigDecimal</code>定义的最小值的字符串表示.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Digits(integer=, fraction=)</td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">String</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types. Additionally supported by HV: any sub-type of <code class="classname">Number</code> and <code class="classname">CharSequence</code>.</td><td align="left" valign="top">Checks whether the annoted value is a number having up to <code class="literal">integer</code> digits and <code class="literal">fraction</code> fractional digits.</td><td align="left" valign="top">对应的数据库表字段会被设置精度(precision)和准度(scale).</td></tr><tr><td align="left" valign="top">@Future</td><td align="left" valign="top"><code class="classname">java.util.Date</code>, <code class="classname">java.util.Calendar</code>; Additionally supported by HV, if the <a class="ulink" href="http://joda-time.sourceforge.net/">Joda Time</a> date/time API is on the class path: any implementations of <code class="classname">ReadablePartial</code> and <code class="classname">ReadableInstant</code>.</td><td align="left" valign="top">检查给定的日期是否比现在晚.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Max</td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types. Additionally supported by HV: any sub-type of<code class="classname">CharSequence</code> (the numeric value represented by the character sequence is evaluated), any sub-type of <code class="classname">Number</code>.</td><td align="left" valign="top">检查该值是否小于或等于约束条件中指定的最大值.</td><td align="left" valign="top">会给对应的数据库表字段添加一个check的约束条件.</td></tr><tr><td align="left" valign="top">@Min</td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types. Additionally supported by HV: any sub-type of <code class="classname">CharSequence</code> (the numeric value represented by the char sequence is evaluated), any sub-type of <code class="classname">Number</code>.</td><td align="left" valign="top">检查该值是否大于或等于约束条件中规定的最小值.</td><td align="left" valign="top">会给对应的数据库表字段添加一个check的约束条件.</td></tr><tr><td align="left" valign="top">@NotNull</td><td align="left" valign="top">Any type</td><td align="left" valign="top">Checks that the annotated value is not <code class="constant">null.</code></td><td align="left" valign="top">对应的表字段不允许为null.</td></tr><tr><td align="left" valign="top">@Null</td><td align="left" valign="top">Any type</td><td align="left" valign="top">Checks that the annotated value is <code class="constant">null.</code></td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Past</td><td align="left" valign="top"><code class="classname">java.util.Date</code>, <code class="classname">java.util.Calendar</code>; Additionally supported by HV, if the <a class="ulink" href="http://joda-time.sourceforge.net/">Joda Time</a> date/time API is on the class path: any implementations of <code class="classname">ReadablePartial</code> and <code class="classname">ReadableInstant</code>.</td><td align="left" valign="top">检查标注对象中的值表示的日期比当前早.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Pattern(regex=, flag=)</td><td align="left" valign="top"><code class="classname">String</code>. Additionally supported by HV: any sub-type of <code class="classname">CharSequence</code>.</td><td align="left" valign="top">检查该字符串是否能够在<em class="parameter"><code>match</code></em>指定的情况下被<em class="parameter"><code>regex</code></em>定义的正则表达式匹配.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Size(min=, max=)</td><td align="left" valign="top"><code class="classname">String</code>, <code class="classname">Collection</code>, <code class="classname">Map</code> and <code class="classname">arrays</code>. Additionally supported by HV: any sub-type of <code class="classname">CharSequence</code>.</td><td align="left" valign="top">Checks if the annotated element's size is between min and max (inclusive).</td><td align="left" valign="top">对应的数据库表字段的长度会被设置成约束中定义的最大值.</td></tr><tr><td align="left" valign="top">@Valid</td><td align="left" valign="top">Any non-primitive type</td><td align="left" valign="top">递归的对关联对象进行校验, 如果关联对象是个集合或者数组, 那么对其中的元素进行递归校验,如果是一个map,则对其中的值部分进行校验.</td><td align="left" valign="top">没有</td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>On top of the parameters indicated in <a class="xref" href="validator-usingvalidator.html#table-spec-constraints" title="表 2.2. Bean Validation constraints">表 2.2 “Bean Validation constraints”</a> each constraint supports the parameters <em class="parameter"><code>message</code></em>, <em class="parameter"><code>groups</code></em> and <em class="parameter"><code>payload</code></em>. This is a requirement of the Bean Validation specification.</p></div></div><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h3 class="title"><a id="validator-defineconstraints-hv-constraints"/>2.4.2. Additional constraints</h3></div></div></div><p>In addition to the constraints defined by the Bean Validation API Hibernate Validator provides several useful custom constraints which are listed in <a class="xref" href="validator-usingvalidator.html#table-custom-constraints" title="表 2.3. Custom constraints">表 2.3 “Custom constraints”</a>. With one exception also these constraints apply to the field/property level, only @ScriptAssert is a class-level constraint.</p><div class="table"><a id="table-custom-constraints"/><p class="title"><b>表 2.3. Custom constraints</b></p><div class="table-contents"><table summary="Custom constraints" border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Supported data types</th><th align="left">作用</th><th align="left">Hibernate metadata impact</th></tr></thead><tbody valign="top"><tr><td align="left" valign="top">@CreditCardNumber</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence passes the Luhn checksum test. Note, this validation aims to check for user mistakes, not credit card validity! See also <a class="ulink" href="http://www.merriampark.com/anatomycc.htm">Anatomy of Credit Card Numbers</a>.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Email</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks whether the specified character sequence is a valid email address. The optional parameters <em class="parameter"><code>regexp</code></em> and <em class="parameter"><code>flags</code></em> allow to specify an additional regular expression (including regular expression flags) which the email must match.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Length(min=, max=)</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Validates that the annotated character sequence is between <em class="parameter"><code>min</code></em> and <em class="parameter"><code>max</code></em> included.</td><td align="left" valign="top">对应的数据库表字段的长度会被设置成约束中定义的最大值.</td></tr><tr><td align="left" valign="top">@ModCheck(modType=, multiplier=, startIndex=, endIndex=, checkDigitPosition=, ignoreNonDigitCharacters=)</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the digits within the annotated character sequence pass the mod 10 or mod 11 checksum algorithm. <code class="constant">modType</code> is used to select the modulo type and the <code class="constant">multiplier</code> determines the algorithm specific multiplier (see also <a class="ulink" href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn algorithm</a>). <code class="constant">startIndex</code> and <code class="constant">endIndex</code> allow to only run the modulo algorithm on the specified sub-string. <code class="constant">checkDigitPosition</code> allows to use an arbitrary digit within the character sequence to be the check digit. If not specified it is assumed that the check digit is part of the specified range. Last but not least, <code class="constant">ignoreNonDigitCharacters</code> allows to ignore non digit characters.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@NotBlank</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence is not null and the trimmed length is greater than 0. The difference to @NotEmpty is that this constraint can only be applied on strings and that trailing whitespaces are ignored.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@NotEmpty</td><td align="left" valign="top"><code class="classname">CharSequence</code>, <code class="classname">Collection</code>, <code class="classname">Map</code> and arrays</td><td align="left" valign="top">Checks whether the annotated element is not <code class="constant">null</code> nor empty.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@Range(min=, max=)</td><td align="left" valign="top"><code class="classname">BigDecimal</code>, <code class="classname">BigInteger</code>, <code class="classname">CharSequence</code>, <code class="classname">byte</code>, <code class="classname">short</code>, <code class="classname">int</code>, <code class="classname">long</code> and the respective wrappers of the primitive types</td><td align="left" valign="top">Checks whether the annotated value lies between (inclusive) the specified minimum and maximum.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@SafeHtml(whitelistType=, additionalTags=)</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks whether the annotated value contains potentially malicious fragments such as <code class="code">&lt;script/&gt;</code>. In order to use this constraint, the <a class="ulink" href="http://jsoup.org/">jsoup</a> library must be part of the class path. With the <em class="parameter"><code>whitelistType</code></em> attribute predefined whitelist types can be chosen. You can also specify additional html tags for the whitelist with the <em class="parameter"><code>additionalTags</code></em> attribute.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@ScriptAssert(lang=, script=, alias=)</td><td align="left" valign="top">Any type</td><td align="left" valign="top">Checks whether the given script can successfully be evaluated against the annotated element. In order to use this constraint, an implementation of the Java Scripting API as defined by JSR 223 ("Scripting for the Java<sup>TM</sup> Platform") must part of the class path. The expressions to be evaluated can be written in any scripting or expression language, for which a JSR 223 compatible engine can be found in the class path.</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@URL(protocol=, host=, port=, regexp=, flags=)</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks if the annotated character sequence is a valid URL according to RFC2396. If any of the optional parameters <em class="parameter"><code>protocol</code></em>, <em class="parameter"><code>host</code></em> or <em class="parameter"><code>port</code></em> are specified, the corresponding URL fragments must match the specified values. The optional parameters <em class="parameter"><code>regexp</code></em> and <em class="parameter"><code>flags</code></em> allow to specify an additional regular expression (including regular expression flags) which the URL must match.</td><td align="left" valign="top">没有</td></tr></tbody></table></div></div><br class="table-break"/><div class="section" lang="zh-CN"><div class="titlepage"><div><div><h4 class="title"><a id="d0e1727"/>2.4.2.1. Country specific constraints</h4></div></div></div><p>Hibernate Validator offers also some country specific constraints, e.g. for the validation of social security numbers. </p><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="note"><h2>注意</h2><p>If you have to implement a country specific constraint, consider making it a contribution to Hibernate Validator!</p></div><div class="table"><a id="table-custom-country-constraints"/><p class="title"><b>表 2.4. Custom country specific constraints</b></p><div class="table-contents"><table summary="Custom country specific constraints" border="1"><colgroup><col align="left"/><col align="left"/><col align="left"/><col align="left"/><col align="left"/></colgroup><thead><tr><th align="left">Annotation</th><th align="left">Supported data types</th><th align="left">作用</th><th align="left">Country</th><th align="left">Hibernate metadata impact</th></tr></thead><tbody valign="top"><tr><td align="left" valign="top">@CNPJ</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence represents a Brazilian corporate tax payer registry number (Cadastro de Pessoa Juríeddica)</td><td align="left" valign="top">Brazil</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@CPF</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence represents a Brazilian individual taxpayer registry number (Cadastro de Pessoa Fídsica).</td><td align="left" valign="top">Brazil</td><td align="left" valign="top">没有</td></tr><tr><td align="left" valign="top">@TituloEleitoral</td><td align="left" valign="top"><code class="classname">CharSequence</code></td><td align="left" valign="top">Checks that the annotated character sequence represents a Brazilian voter ID card number (<a class="ulink" href="http://ghiorzi.org/cgcancpf.htm">Título Eleitoral</a>).</td><td align="left" valign="top">Brazil</td><td align="left" valign="top">没有</td></tr></tbody></table></div></div><br class="table-break"/><div xmlns:rf="java:org.jboss.highlight.XhtmlRendererFactory" class="tip"><h2>提示</h2><p>In some cases neither the Bean Validation constraints nor the custom constraints provided by Hibernate Validator will fulfill your requirements. In this case you can easily write your own constraint. We will discuss this in <a class="xref" href="validator-customconstraints.html" title="第 3 章 创建自己的约束规则">第 3 章 <i>创建自己的约束规则</i></a>.</p></div></div></div></div></div><HR xmlns=""/><a xmlns="" href=""><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">版权 © 2009 - 2013 Red Hat, Inc. &amp; Gunnar Morling</p></a><ul class="docnav"><li class="previous"><a accesskey="p" href="validator-gettingstarted.html"><strong>上一页</strong>第 1 章 开始入门</a></li><li class="up"><a accesskey="u" href="#"><strong>上一级</strong></a></li><li class="home"><a accesskey="h" href="index.html"><strong>起始页</strong></a></li><li class="next"><a accesskey="n" href="validator-customconstraints.html"><strong>下一页</strong>第 3 章 创建自己的约束规则</a></li></ul></body></html>